# 生成式深度學習練習

本資料夾用於生成式深度學習的練習和研究。

---

## 資料集來源

- `aclImdb_v1`：IMDB 影評情感分析資料集（來源：<https://ai.stanford.edu/~amaas/data/sentiment/>）

---

## 採樣方法概念

在生成式模型中，採樣方法決定了模型如何選擇下一個令牌（token）或動作。以下介紹三個核心概念及其關係。

### 1. 貪心採樣 (Greedy Sampling)

**核心概念**：永遠選擇概率最高的選項。

- **確定性**：同樣的輸入永遠產生同樣的輸出
- **選擇方法**：每一步都挑選概率最高的令牌/動作
- **特點**：
  - 速度快，計算效率高
  - 容易產生重複、單調的輸出
  - 傾向選擇最"明顯"的續文
  - 沒有隨機性

**例子**：如果概率是 `[0.7, 0.2, 0.05, 0.05]`，永遠挑第一個選項。

---

### 2. 隨機採樣 (Stochastic Sampling)

**核心概念**：根據概率分佈隨機選擇選項。

- **非確定性**：相同的輸入可能產生不同的輸出
- **選擇方法**：根據概率分佈進行採樣（尊重各選項的概率比例）
- **特點**：
  - 輸出多樣化，更有創意
  - 可能產生意外但合理的續文
  - 速度比貪心採樣慢
  - 包含隨機性/變異性

**例子**：概率 `[0.7, 0.2, 0.05, 0.05]`，70% 機率挑第一個，20% 挑第二個，以此類推。

---

### 3. Softmax Temperature (溫度)

**溫度** 是一個控制概率分佈"銳度"的參數。

#### 溫度運作原理

原始邏輯分數通過 softmax 轉換為概率：

```
P(token_i) = exp(logits_i / T) / Σ exp(logits_j / T)
```

其中 **T** 就是溫度。

#### 三種溫度情況

**1. T = 1.0（標準溫度）**
- 原始的 softmax 分佈
- 保持模型的自然概率分佈

**2. T < 1.0（低溫）**
- 概率分佈變得**更尖銳、更集中**
- 高概率選項的差異被放大
- 效果接近**貪心採樣**
- 輸出更確定、更保守

範例：`[0.7, 0.2, 0.05, 0.05]` → `[0.92, 0.07, 0.005, 0.005]`

**3. T > 1.0（高溫）**
- 概率分佈變得**更平緩、更均勻**
- 各選項的概率差異被縮小
- 所有選項更有機會被選中
- 輸出更隨機、更多樣化

範例：`[0.7, 0.2, 0.05, 0.05]` → `[0.54, 0.30, 0.08, 0.08]`

---

## 三者的整體關係

| 面向 | 貪心採樣 | 隨機採樣 |
|------|---------|---------|
| **確定性** | 確定性 | 非確定性 |
| **多樣性** | 低（重複） | 高（多變） |
| **速度** | 快 | 慢 |
| **使用場景** | 翻譯、摘要 | 創意寫作、對話 |
| **變異度** | 零 | 高 |

### 熵與隨機性

- 熵越大代表概率分佈越均勻，模型的選擇越沒有定論，其輸出的隨機性也就越高。

### 溫度與採樣的結合

```
低溫 (T<1)  →  貪心採樣效果
   ↓
標準溫度 (T=1)  →  隨機採樣（自然分佈）
   ↓
高溫 (T>1)  →  隨機採樣（高度隨機）
```

---

## 實際應用舉例

假設 logits = `[2.0, 1.0, 0.0, 0.0]`

### T = 0.5（低溫 - 保守）
```
P = [0.88, 0.10, 0.01, 0.01]  ← 貪心傾向強
```

### T = 1.0（標準 - 平衡）
```
P = [0.73, 0.20, 0.04, 0.04]  ← 正常分佈
```

### T = 2.0（高溫 - 創意）
```
P = [0.54, 0.28, 0.09, 0.09]  ← 更平均，隨機性高
```

---

## 常見的隨機採樣方法

- **Random Sampling**：直接從分佈中採樣
- **Top-k Sampling**：只從概率最高的 k 個令牌中採樣
- **Nucleus (Top-p) Sampling**：從累積概率超過 p 的最小令牌集中採樣
- **Temperature Sampling**：調整溫度來控制隨機程度

---

## 總結

- **貪心採樣** = 低溫 + 確定性選擇
- **隨機採樣** = 溫度可調 + 概率分佈採樣
- **溫度** 是調整「確定性」vs「多樣性」的關鍵參數
